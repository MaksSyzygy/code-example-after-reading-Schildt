using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Учеба
{
    internal class Account
    {
        public string name;
        public string city;
        public string bankid;
        public int money;
        public string adress;
        public string phone;
        public int debt;
        public int credit;
        public string password;

        public new string ToString() { return $"Имя - {name}\nГород - {city}\nНомер счета - {bankid}\nСумма - {money}\nЗадолженность за коммунальные - {debt}\nЗадолженность по кредитам - {credit}\nАдрес - {adress}\nТелефон - {phone}"; }
    }

    internal class AccountData
    {
        public Dictionary<string, Account> data = new Dictionary<string, Account>();
        public AccountData()
        {
            data.Add("вася", new Account { name = "Вася", city = "Киев", bankid = "78yrw3", money = 658, debt = 300, credit = 200, adress = "ж/м Подол", phone = "0635555555", password = "12345" });
            data.Add("петя", new Account { name = "Петя", city = "Днепр", bankid = "67t897", money = 589, debt = 600, credit = 1500, adress = "ж/м Тополь", phone = "0987777777", password = "54321" });
            data.Add("маша", new Account { name = "Маша", city = "Львов", bankid = "7y887", money = 547, debt = 450, credit = 700, adress = "ул. Шевченко", phone = "0504569874", password = "09876" });
            data.Add("света", new Account { name = "Света", city = "Одесса", bankid = "432rw", money = 100, debt = 1000, credit = 2000, adress = "просп. Свободы", phone = "0972845649", password = "15975" });
        }
    }

    class Program
    {
        static void Main()
        {
            Account account = new Account();
            AccountData accountData = new AccountData();

            Console.WriteLine("Вас приветствует симулятор Приват-Банка 3.0!");
            Console.WriteLine();


            while (true)
            {
                Console.Write("Введите имя пользователя - ");

                string nickname = Console.ReadLine();

                if (nickname.ToLower() == "q")
                {
                    break;
                }

                if(accountData.data.TryGetValue(nickname.ToLower(), out account) == false)
                {
                    Console.WriteLine($"Имя {nickname} не найдено");
                    continue;
                }

                while (true)
                {
                    Console.Write($"Введите пароль для аккаунта {nickname} - ");
                    string password = Console.ReadLine();

                    if (password != account.password)
                    {
                        Console.WriteLine("Неправильный пароль");
                        continue;
                    }
                    break;
                }

                while (true)
                {
                    Console.WriteLine($"\nВыберите операцию из списка\n");

                    Console.WriteLine($"1. Информация о клиенте");
                    Console.WriteLine($"2. Внести деньги на счет");
                    Console.WriteLine($"3. Внести деньги на благотворительность");
                    Console.WriteLine($"4. Оплатить за коммунальные платежи");
                    Console.WriteLine($"5. Погасить кредит");
                    Console.WriteLine($"6. Выйти из аккаунта\n");

                    var operation = Console.ReadLine();

                    switch (operation.ToLower())
                    {
                        case "1":
                            Console.WriteLine(account.ToString());
                            break;
                        case "2":
                            while (true)
                            {
                                Console.WriteLine("Укажите добавляемую сумму");
                                var InputAmount = Console.ReadLine();

                                int amount;
                                if(Int32.TryParse(InputAmount, out amount) == false || amount <= 0)
                                {
                                    Console.WriteLine("Некорректный выбор");
                                    continue;
                                }

                                account.money += amount;
                                Console.WriteLine($"Добавлено {amount}, на счету теперь {account.money}");
                                break;
                            }
                            break;
                        case "3":
                            while (true)
                            {
                                Console.Write("Укажите сумму на благотворительность - ");
                                var InputAmount = Console.ReadLine();

                                int amount;
                                if (Int32.TryParse(InputAmount, out amount) == false || amount <= 0)
                                {
                                    Console.WriteLine("Некорректный выбор");
                                    continue;
                                }

                                account.money -= amount;
                                Console.WriteLine($"На благотворительность отправлено {amount}, спасибо за Вашу помощь!");
                                Console.WriteLine($"Сумма на счету - {account.money}");
                                break;
                            }
                            break;
                        case "4":
                            while (true)
                            {
                                if (account.debt == 0)
                                {
                                    Console.WriteLine("У Вас нет долгов по коммунальным платежам");
                                    break;
                                }
                                if (account.debt < 0)
                                {
                                    Console.WriteLine("У Вас нет долгов по коммунальным платежам!");
                                    Console.WriteLine($"Сумма переплаты в счет на следующий месяц составляет - {Math.Abs(account.debt)}");
                                    break;
                                }
                                else
                                {
                                    Console.Write($"Задолженность по коммунальным составляет {account.debt}, сумма к оплате - ");
                                    var InputAmount = Console.ReadLine();

                                    int amount;
                                    if (Int32.TryParse(InputAmount, out amount) == false || amount <= 0 || amount > account.money)
                                    {
                                        Console.WriteLine("Некорректный выбор");
                                        continue;
                                    }

                                    account.money -= amount;
                                    account.debt -= amount;

                                    if (account.debt == 0)
                                    {
                                        Console.WriteLine("Долг за коммунальные платежи оплачен");
                                    }
                                    else if (account.debt < 0)
                                    {
                                        Console.WriteLine($"Сумма переплаты в счет на следующий месяц составляет - {Math.Abs(account.debt)}");
                                    }
                                    else
                                    {
                                        Console.WriteLine($"Ваш долг за коммунальные теперь составляет - {account.debt}");
                                    }
                                }
                                break;
                            }
                            break;
                        case "5":
                            while (true)
                            {
                                if (account.credit <= 0)
                                {
                                    Console.WriteLine("У Вас нет долгов по кредитным средствам");
                                    break;
                                }
                                else
                                {
                                    Console.Write($"Задолженность по кредитным средствам - {account.credit}, сумма к оплате - ");
                                    var InputAmount = Console.ReadLine();

                                    int amount;
                                    if (Int32.TryParse(InputAmount, out amount) == false || amount <= 0)
                                    {
                                        Console.WriteLine("Некорректный выбор");
                                        continue;
                                    }

                                    if(amount > account.money)
                                    {
                                        Console.WriteLine("Недостаточно средств");
                                        continue;
                                    }

                                    account.money -= amount;
                                    account.credit -= amount;

                                    if (account.credit <= 0)
                                    {
                                        Console.WriteLine("У Вас нет долгов по кредитным средствам");
                                    }
                                    else
                                    {
                                        Console.WriteLine($"Ваш долг по кредитным средствам составляет - {account.credit}");
                                    }
                                }
                                break;
                            }
                            break;
                        case "6":
                            Console.WriteLine("Вы вышли из аккаунта! Всего доброго");
                            return;
                        default:
                            Console.WriteLine($"Некорректный ввод {operation}, повторите ввод");
                            break;
                    }
                }
            }
        }
    }
}
